# SPDX-FileCopyrightText: 2025 Sebastian KÃ¼the and (other) contributors to project grafana-oss-team-sync <https://github.com/skuethe/grafana-oss-team-sync>
# SPDX-License-Identifier: GPL-3.0-or-later

services:
  grafana:
    image: docker.io/grafana/grafana-oss:latest@sha256:70d9599b186ce287be0d2c5ba9a78acb2e86c1a68c9c41449454d0fc3eeb84e8
    container_name: grafana
    restart: unless-stopped
    ports:
     - '3000:3000'
    depends_on:
      devproxy:
        condition: service_healthy

  devproxy:
    image: ghcr.io/dotnet/dev-proxy:2.0.0@sha256:c1b061b862fe96b31d69aa11e43abebf44099bad3d590a0251b15c805b84e218
    container_name: devproxy
    ports:
    - '8000:8000'
    - '8897:8897'
    healthcheck:
      test: /bin/bash -c "echo >/dev/tcp/localhost/8897"
    volumes:
      - '../test/devproxy/configs:/config:ro'
    command:
    - '--config-file'
    - '/config/entraid.json'

  ldap:
    image: docker.io/bitnamilegacy/openldap:latest@sha256:8c0ba3a0429f691800f99b8462901c8b923a03733eda14bd3f168d560b81d3b7
    container_name: openldap
    environment:
      - BITNAMI_DEBUG=true
    ports:
      - 1389:1389
      - 1636:1636
    volumes:
      - '../test/openldap:/ldifs:ro'
